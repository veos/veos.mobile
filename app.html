<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1" /> 
        <title>SurveillanceWatch</title>

        <link rel="stylesheet" href="js/libs/jquery.mobile-1.3.2.min.css" />
        
        <link rel="stylesheet" href="themes/humane-original.css" />
        <link rel="stylesheet" href="themes/veos.css" />
        <link rel="stylesheet" href="css/veos.css" />
        
        <link rel="icon" href="images/favicon.ico"/>

        <script src="js/libs/jquery-1.9.1.min.js"></script>
        <script src="js/libs/humane.min.js"></script>

        <script type="text/javascript">
            $.noConflict();
            jQuery(document).bind("mobileinit", function(){
              jQuery.mobile.defaultPageTransition = 'none'; // disable transitions
              jQuery.mobile.defaultDialogTransition = 'none';
              jQuery.mobile.pushStateEnabled = false; // disable history rewriting
            });
        </script>
        
        <script type="text/javascript"
            src="//maps.googleapis.com/maps/api/js?key=AIzaSyB75fl3V3AXVEfejWZiIclVB73SuLESB8w&amp;sensor=true"></script>        

        <script src="js/libs/deps.postinit.BUNDLE.js"></script>
        <!-- <script type="text/javascript" charset="utf-8" src="js/libs/piwik.js"></script> -->  
        <script type="text/javascript" charset="utf-8" src="js/veos.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/veos.map.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/veos.model.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/veos.view.js"></script>

        <!-- Google Analytics -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          // veos._gaq.push(['_setAccount', 'UA-37322083-2']);
          // veos._gaq.push(['_setDomainName', 'watch.surveillancerights.ca']);
          // veos._gaq.push(['_gat._anonymizeIp']);
          // veos._gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>

        <script type="text/javascript">
            veos.init();

            jQuery(document).ready(function () {
                // veos.setUpPiwik();
                if (location.hash == "") {
                    jQuery.mobile.changePage("overview-map.html");
                }
            });
        </script>
    </head>
    <body>
        <script type="text/javascript">
            // jQuery('[data-role=page]').on('pageshow', function (event, ui) {
            //   try {
            //     _gaq.push( ['_trackPageview', event.target.id] );
            //     console.log(event.target.id);
            //   } catch(err) {
            //   }
            // });
            jQuery(document).on('pageshow', '[data-role=page]', function (ev, ui) {
                try {
                    _gaq.push(['_setAccount', 'UA-37322083-2']);

                    hash = location.hash;

                    if (hash) {
                        _gaq.push(['_trackPageview', hash.substr(1)]);
                        console.log('Recorded Google Analytics data for page: ' + hash.substr(1));
                    } else {
                        _gaq.push(['_trackPageview']);
                    }
                } catch(err) {
                    console.warn('Unable to record Google Analytics data for page: ' + ev.target.id);
                }
            });
        </script>
    </body>
</html>
